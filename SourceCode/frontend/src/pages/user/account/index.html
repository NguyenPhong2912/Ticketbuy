<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>T√†i kho·∫£n c·ªßa t√¥i - GreenBus</title>
  <link rel="stylesheet" href="account.css?v=3.0" />
</head>
<body>

  <header class="site-header">
    <div class="container header-inner">
      <div class="logo">
        <img src="../../../assets/images/logo1.png" data-asset-src="images/logo1.png" alt="GreenBus Logo" />
        <span class="brand">GreenBus</span>
      </div>
      <nav class="main-nav">
        <a href="../home page/index.html">Trang ch·ªß</a>
        <a href="../booking/index.html">ƒê·∫∑t v√©</a>
        <a href="../routes/index.html">Tuy·∫øn ph·ªï bi·∫øn</a>
        <a href="../about/index.html">V·ªÅ ch√∫ng t√¥i</a>
        <div class="user-nav" id="userNav">
          <button class="user-toggle hidden" id="userMenuToggle" type="button">
            <span class="user-name" id="userMenuName">T√†i kho·∫£n</span>
            <span class="user-role" id="userMenuRole"></span>
            <svg width="14" height="14" viewBox="0 0 24 24" aria-hidden="true">
              <path fill="currentColor" d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <div class="user-dropdown hidden" id="userDropdown">
            <div class="user-info">
              <p id="userDropdownName">GreenBus</p>
              <small id="userDropdownEmail"></small>
            </div>
            <a href="index.html">B·∫£ng ƒëi·ªÅu khi·ªÉn t√†i kho·∫£n</a>
            <button type="button" id="logoutBtn">ƒêƒÉng xu·∫•t</button>
          </div>
          <a href="../../auth/login.html" class="btn-login" id="navAuthLink">ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</a>
        </div>
      </nav>
    </div>
  </header>

  <main class="account-shell">
    <section class="card account-hero">
      <div>
        <p class="eyebrow">T√†i kho·∫£n c·ªßa b·∫°n</p>
        <h1 id="accountGreeting">Xin ch√†o!</h1>
        <p class="hero-copy">Qu·∫£n l√Ω th√¥ng tin c√° nh√¢n, theo d√µi v√© ƒë√£ ƒë·∫∑t v√† ph∆∞∆°ng th·ª©c thanh to√°n trong m·ªôt n∆°i duy nh·∫•t.</p>
      </div>
      <div class="badge" id="roleBadge">ƒêang t·∫£i‚Ä¶</div>
    </section>

    <section class="stats-grid" id="accountStats">
      <article class="stat-card">
        <p class="stat-label">T·ªïng v√© ƒë√£ ƒë·∫∑t</p>
        <p class="stat-value" id="statTotalTickets">0</p>
        <span class="stat-trend">T√≠nh c·∫£ l·ªãch s·ª≠</span>
      </article>
      <article class="stat-card">
        <p class="stat-label">V√© ƒëang ch·ªù</p>
        <p class="stat-value" id="statPendingTickets">0</p>
        <span class="stat-trend status-neutral">Ch·ªù x√°c nh·∫≠n</span>
      </article>
      <article class="stat-card">
        <p class="stat-label">Ph∆∞∆°ng th·ª©c thanh to√°n</p>
        <p class="stat-value" id="statPaymentMethods">0</p>
        <span class="stat-trend">L∆∞u ƒë·ªÉ thanh to√°n nhanh</span>
      </article>
    </section>

    <section class="card profile-card">
      <div class="card-header">
        <h2>Th√¥ng tin c√° nh√¢n</h2>
        <span class="status-pill online">ƒê√£ x√°c th·ª±c</span>
      </div>
      <div id="adminPanelButton" class="admin-panel-button hidden" style="margin-bottom: 24px;">
        <a href="../../admin/admin/admin.html" class="btn-admin-panel">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
          </svg>
          V√†o trang qu·∫£n l√Ω
        </a>
      </div>
      <dl class="profile-details">
        <div>
          <dt>H·ªç v√† t√™n</dt>
          <dd id="profileName">‚Äî</dd>
        </div>
        <div>
          <dt>Email</dt>
          <dd id="profileEmail">‚Äî</dd>
        </div>
        <div>
          <dt>S·ªë ƒëi·ªán tho·∫°i</dt>
          <dd id="profilePhone">‚Äî</dd>
        </div>
        <div>
          <dt>Vai tr√≤</dt>
          <dd id="profileRole">‚Äî</dd>
        </div>
        <div>
          <dt>Ng√†y tham gia</dt>
          <dd id="profileJoin">‚Äî</dd>
        </div>
      </dl>
    </section>

    <section class="card bookings-card">
      <div class="card-header">
        <h2>V√© ƒë√£ ƒë·∫∑t</h2>
        <div class="header-actions">
          <button class="ghost-btn" type="button" id="generateQRBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 6px; vertical-align: middle;">
              <rect x="3" y="3" width="5" height="5"></rect>
              <rect x="16" y="3" width="5" height="5"></rect>
              <rect x="3" y="16" width="5" height="5"></rect>
              <path d="M21 16h-3"></path>
              <path d="M9 21v-3"></path>
              <path d="M21 12v-1"></path>
              <path d="M12 3H13"></path>
              <path d="M3 12h1"></path>
              <path d="M12 8v1"></path>
            </svg>
            T·∫°o QR
          </button>
          <button class="ghost-btn" type="button" id="refreshBookingsBtn">L√†m m·ªõi</button>
        </div>
      </div>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>M√£</th>
              <th>Tuy·∫øn</th>
              <th>Ng√†y ƒëi</th>
              <th>S·ªë gh·∫ø</th>
              <th>Gh·∫ø</th>
              <th>Tr·∫°ng th√°i</th>
            </tr>
          </thead>
          <tbody id="bookingRows">
            <tr><td colspan="6" class="muted">ƒêang t·∫£i d·ªØ li·ªáu‚Ä¶</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <section class="card payments-card">
      <div class="card-header">
        <div>
          <h2>Ph∆∞∆°ng th·ª©c thanh to√°n</h2>
          <p class="muted">L∆∞u th·∫ª ho·∫∑c t√†i kho·∫£n ng√¢n h√†ng ƒë·ªÉ thanh to√°n nhanh h∆°n.</p>
        </div>
        <button class="btn-pill" type="button" id="togglePaymentForm">Th√™m m·ªõi</button>
      </div>
      <ul class="payment-list" id="paymentList">
        <li class="muted">Ch∆∞a c√≥ ph∆∞∆°ng th·ª©c n√†o.</li>
      </ul>
      <form class="payment-form hidden" id="paymentForm">
        <div class="form-group">
          <label>
            <span>Ph∆∞∆°ng th·ª©c thanh to√°n</span>
            <select id="paymentMethod" required>
              <option value="card">Th·∫ª Visa/Mastercard/JCB</option>
              <option value="vietqr">VietQR</option>
              <option value="momo">MoMo</option>
            </select>
          </label>
        </div>
        
        <!-- Card Payment Fields -->
        <div id="cardFields" class="payment-method-fields">
          <div class="form-grid">
            <label>
              <span>T√™n hi·ªÉn th·ªã</span>
              <input type="text" id="paymentLabel" placeholder="Th·∫ª Visa c√° nh√¢n" />
            </label>
            <label>
              <span>Lo·∫°i th·∫ª</span>
              <select id="paymentBrand">
                <option value="visa">Visa</option>
                <option value="mastercard">Mastercard</option>
                <option value="jcb">JCB</option>
              </select>
            </label>
            <label>
              <span>4 s·ªë cu·ªëi</span>
              <input type="text" id="paymentLast4" maxlength="4" pattern="[0-9]{4}" placeholder="1234" />
            </label>
            <label>
              <span>Ng√†y h·∫øt h·∫°n</span>
              <input type="text" id="cardExpiry" placeholder="MM/YY" maxlength="5" />
            </label>
            <label>
              <span>CVV</span>
              <input type="text" id="cardCVV" placeholder="123" maxlength="3" />
            </label>
            <label>
              <span>T√™n ch·ªß th·∫ª</span>
              <input type="text" id="cardName" placeholder="NGUYEN VAN A" />
            </label>
          </div>
        </div>

        <!-- VietQR Fields -->
        <div id="vietqrFields" class="payment-method-fields hidden">
          <div class="form-group">
            <label>
              <span>T√™n hi·ªÉn th·ªã</span>
              <input type="text" id="vietqrLabel" placeholder="VietQR - Ng√¢n h√†ng ABC" />
            </label>
          </div>
          <div class="payment-note">
            <small>üì± Qu√©t m√£ QR b·∫±ng ·ª©ng d·ª•ng ng√¢n h√†ng ƒë·ªÉ thanh to√°n</small>
          </div>
        </div>

        <!-- MoMo Fields -->
        <div id="momoFields" class="payment-method-fields hidden">
          <div class="form-grid">
            <label>
              <span>T√™n hi·ªÉn th·ªã</span>
              <input type="text" id="momoLabel" placeholder="MoMo - S·ªë ƒëi·ªán tho·∫°i" />
            </label>
            <label>
              <span>S·ªë ƒëi·ªán tho·∫°i MoMo</span>
              <input type="tel" id="momoPhone" placeholder="0901234567" />
            </label>
          </div>
          <div class="payment-note">
            <small>üí≥ Thanh to√°n qua v√≠ ƒëi·ªán t·ª≠ MoMo</small>
          </div>
        </div>

        <div class="form-group">
          <label>
            <span>ƒê·∫∑t l√†m m·∫∑c ƒë·ªãnh</span>
            <select id="paymentDefault">
              <option value="no" selected>Kh√¥ng</option>
              <option value="yes">C√≥</option>
            </select>
          </label>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-primary">L∆∞u ph∆∞∆°ng th·ª©c</button>
          <button type="button" class="ghost-btn" id="cancelPaymentForm">Hu·ª∑</button>
        </div>
      </form>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div>
        <strong>GreenBus Lines</strong>
        <p>ƒê·ªãa ch·ªâ: 549-36 L√™ VƒÉn Th·ªç, G√≤ V·∫•p, TP.HCM ¬∑ Hotline: 1900-1234</p>
      </div>
      <div>¬© 2025 GreenBus</div>
    </div>
  </footer>

  <div class="toast-stack" id="toastStack" aria-live="polite" aria-atomic="true"></div>

  <!-- Modal ch·ªçn v√© ƒë·ªÉ t·∫°o QR -->
  <div class="modal-overlay hidden" id="qrModalOverlay">
    <div class="modal-content">
      <div class="modal-header">
        <h2>T·∫°o m√£ QR cho v√©</h2>
        <button type="button" class="modal-close" id="closeQRModal">&times;</button>
      </div>
      <div class="modal-body">
        <p class="modal-description">Ch·ªçn v√© ƒë√£ x√°c nh·∫≠n ƒë·ªÉ t·∫°o m√£ QR:</p>
        <div class="booking-selection" id="bookingSelection">
          <p class="muted">ƒêang t·∫£i danh s√°ch v√©...</p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="ghost-btn" id="cancelQRModal">H·ªßy</button>
        <button type="button" class="btn-primary" id="generateQRSubmit" disabled>T·∫°o QR</button>
      </div>
    </div>
  </div>

  <script src="../../../helpers/assets.js"></script>
  <script src="../../../helpers/api.js"></script>
  <script src="account.js?v=3.0"></script>
</body>
</html>
